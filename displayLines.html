<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>create an edge</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden; 
        }
        svg {
            width: 100%;
            height: 100%;
            position: absolute;
        }
        #lineWidth {
            position: absolute;
            top: 10px;
            padding: 10px 20px;
            font-size: 1.2em;
            border: 2px solid #000;
            border-radius: 5px;
            background-color: #fff;
            cursor: pointer;
            z-index: 10; 
            right: 200px;
        }

        #lineStyle, #undoButton {
            position: absolute;
            top: 10px;
            padding: 10px 20px;
            font-size: 1.2em;
            border: 2px solid #000;
            border-radius: 5px;
            background-color: #fff;
            cursor: pointer;
            pointer-events: stroke;
            align-items: center;
            z-index: 10; 
            margin: 0 auto; 
        }
        #lineStyle {
            right: 40px;
            display: block;
            margin: 0 auto; /* Center the select element */
            text-align: center; /* Center the text within the select element */
            padding: 10px;
            font-size: 1.2em;
        }
        #undoButton {
            right: 1240px;
            display: block;
            margin: 0 auto; /* Center the button element */
            padding: 10px 20px;
            font-size: 1.2em;
            border: 2px solid #000;
            border-radius: 5px;
            background-color: #fff;
            cursor: pointer;
            z-index: 10;
        }
    </style>
</head>
<body>
    <select id="lineStyle">
        <option value="">Solid</option>
        <option value="5,5">Dashed</option>
        <option value="1,5">Dotted</option>
        <option value="15,10,5,10">Dash-Dot</option>
    </select>
    <button id="undoButton">Erase Lines</button>

    <select id="lineWidth">
        <option value="1">1px</option>
        <option value="2">2px</option>
        <option value="4" selected>4px</option>
        <option value="6">6px</option>
        <option value="8">8px</option>
        <option value="10">10px</option>
    </select>
    <svg id="svg"></svg>
    <script>
        let colors = ['purple', 'lightblue', 'green', 'red', 'orange', 'pink', 'mediumslateblue', 'mediumseagreen', 'rgb(183, 183, 244)', 
                      'rosybrown', 'olivedrab', 'crimson', 'rgb(213, 213, 55)', 'palevioletred', 'indigo', 'coral', 'teal', 'plum', 
                      'navy', 'yellowgreen'];
        let index = 0;
        let drawing = false;
        let startOfLine = null;
        let lines = [];
        let line = null;
        let isEraseMode = false; 
        let svg = document.getElementById('svg');
        svg.addEventListener('mousedown', startLine);
        svg.addEventListener('mousemove', createLline);
        svg.addEventListener('mouseup', endLine);
        document.getElementById('undoButton').addEventListener('click', toggleEraseMode);

        let lineStyle = document.getElementById('lineStyle');
    
    
        function startLine(event) {
            if (isEraseMode || drawing) {
                return;
            }
            drawing = true;
            const rect = svg.getBoundingClientRect(); 
            startOfLine = {
                x: event.clientX - rect.left,
                y: event.clientY - rect.top
            };
            line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', startOfLine.x);
            line.setAttribute('y1', startOfLine.y);
            line.setAttribute('x2', startOfLine.x);
            line.setAttribute('y2', startOfLine.y);
            line.setAttribute('stroke', colors[index]);
            let lineWidth = document.getElementById('lineWidth').value;
            line.setAttribute('stroke-width', lineWidth);
            line.setAttribute('stroke-dasharray', lineStyle.value);
            svg.appendChild(line);
        }

    
        function createLline(event) {
            if (!drawing) {
                return;
            }
            const rect = svg.getBoundingClientRect();
            line.setAttribute('x2', event.clientX - rect.left);
            line.setAttribute('y2', event.clientY - rect.top);
        }
    
        function endLine() {
            if (!drawing) {
                return;
            }
            drawing = false;
            lines.push(line);
            index = (index + 1) % colors.length;

            let clickTarget = line.cloneNode();
            clickTarget.setAttribute('stroke-width', '10');
            clickTarget.setAttribute('stroke', 'transparent');
            svg.appendChild(clickTarget);

            clickTarget.addEventListener('click', function(e) {
                console.log("Line clicked"); // Debug
                if (isEraseMode) {
                    e.target.previousSibling.remove(); 
                    e.target.remove();
                    lines = lines.filter(l => l !== e.target.previousSibling);
                }
            });
        }
    
        function toggleEraseMode() {
            isEraseMode = !isEraseMode;
            document.getElementById('undoButton').textContent = isEraseMode ? 'Exit Erase Mode' : 'Erase Lines';
        }
    </script>
</body>
</html>
